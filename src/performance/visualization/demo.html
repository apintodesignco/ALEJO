<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ALEJO Performance Visualization Demo</title>
  <style>
    :root {
      --primary-color: #3498db;
      --secondary-color: #2ecc71;
      --accent-color: #e74c3c;
      --text-color: #333;
      --background-color: #f9f9f9;
      --card-background: #fff;
      --border-color: #ddd;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      line-height: 1.6;
      color: var(--text-color);
      background-color: var(--background-color);
      margin: 0;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      margin-bottom: 30px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 20px;
    }

    h1 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .description {
      color: #666;
      font-size: 1.1em;
      max-width: 800px;
    }

    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }

    .chart-container {
      background-color: var(--card-background);
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 20px;
      min-height: 300px;
    }

    .chart-container h2 {
      margin-top: 0;
      font-size: 1.2em;
      color: var(--primary-color);
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
      margin-bottom: 15px;
    }

    .full-width {
      grid-column: 1 / -1;
    }

    .controls {
      background-color: var(--card-background);
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      padding: 20px;
      margin-bottom: 20px;
    }

    .control-group {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    button {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.2s;
    }

    button:hover {
      background-color: #2980b9;
    }

    button.secondary {
      background-color: var(--secondary-color);
    }

    button.secondary:hover {
      background-color: #27ae60;
    }

    button.danger {
      background-color: var(--accent-color);
    }

    button.danger:hover {
      background-color: #c0392b;
    }

    .alejo-chart-tooltip {
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 12px;
      pointer-events: none;
      z-index: 100;
    }

    /* Accessibility styles */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    @media (max-width: 768px) {
      .dashboard {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ALEJO Performance Visualization Demo</h1>
      <p class="description">
        This demo showcases ALEJO's visualization components for performance monitoring.
        The charts below display simulated performance data that updates in real-time.
      </p>
    </header>

    <div class="controls">
      <h2>Demo Controls</h2>
      <div class="control-group">
        <button id="start-demo">Start Demo</button>
        <button id="stop-demo" class="danger">Stop Demo</button>
        <button id="update-data" class="secondary">Update Once</button>
      </div>
      <div class="control-group">
        <label for="update-interval">Update Interval (ms):</label>
        <input type="range" id="update-interval" min="500" max="5000" step="500" value="2000">
        <span id="interval-display">2000</span>
      </div>
    </div>

    <div class="dashboard">
      <div class="chart-container full-width">
        <h2>CPU Usage Over Time</h2>
        <div id="cpu-line-chart"></div>
      </div>
      
      <div class="chart-container">
        <h2>Current CPU Usage</h2>
        <div id="cpu-gauge-chart"></div>
      </div>
      
      <div class="chart-container">
        <h2>Memory Usage</h2>
        <div id="memory-gauge-chart"></div>
      </div>
      
      <div class="chart-container full-width">
        <h2>Resource Usage by Component</h2>
        <div id="resource-bar-chart"></div>
      </div>
    </div>
  </div>

  <script type="module">
    import Visualization from './index.js';
    
    // Initialize the visualization system
    Visualization.initialize();
    
    // Demo data and state
    let demoRunning = false;
    let updateInterval = 2000;
    let intervalId = null;
    
    // CPU usage time series data
    const cpuTimeSeriesData = {
      labels: Array.from({ length: 20 }, (_, i) => new Date(Date.now() - (19 - i) * 1000)),
      datasets: [
        {
          label: 'CPU Usage',
          data: Array.from({ length: 20 }, () => Math.random() * 30 + 10),
          color: '#3498db'
        }
      ]
    };
    
    // Resource usage by component data
    const resourceUsageData = [
      { label: 'Voice System', value: 35 },
      { label: 'Vision System', value: 25 },
      { label: 'Memory System', value: 15 },
      { label: 'Reasoning Engine', value: 20 },
      { label: 'UI Components', value: 5 }
    ];
    
    // Current gauge values
    let currentCpuValue = 25;
    let currentMemoryValue = 40;
    
    // Create charts
    const cpuLineChart = Visualization.createLineChart({
      containerId: 'cpu-line-chart',
      title: 'CPU Usage Over Time',
      xAxisLabel: 'Time',
      yAxisLabel: 'Usage (%)',
      height: 300,
      animation: true,
      tooltip: {
        enabled: true,
        formatter: (item) => `${item.label}: ${item.value.toFixed(1)}%`
      },
      accessibility: {
        enabled: true,
        ariaLabel: 'CPU usage over time line chart',
        includeDataTable: true
      }
    });
    
    const cpuGaugeChart = new Visualization.components.GaugeChart({
      containerId: 'cpu-gauge-chart',
      title: 'CPU Usage',
      units: '%',
      minValue: 0,
      maxValue: 100,
      value: currentCpuValue,
      thresholds: [
        { value: 60, color: '#2ecc71' }, // Green for good
        { value: 80, color: '#f39c12' }, // Orange for warning
        { value: 100, color: '#e74c3c' } // Red for critical
      ],
      accessibility: {
        enabled: true,
        ariaLabel: 'CPU usage gauge',
        includeDataTable: true
      }
    });
    
    const memoryGaugeChart = new Visualization.components.GaugeChart({
      containerId: 'memory-gauge-chart',
      title: 'Memory Usage',
      units: '%',
      minValue: 0,
      maxValue: 100,
      value: currentMemoryValue,
      thresholds: [
        { value: 60, color: '#2ecc71' }, // Green for good
        { value: 80, color: '#f39c12' }, // Orange for warning
        { value: 100, color: '#e74c3c' } // Red for critical
      ],
      accessibility: {
        enabled: true,
        ariaLabel: 'Memory usage gauge',
        includeDataTable: true
      }
    });
    
    const resourceBarChart = Visualization.createBarChart({
      containerId: 'resource-bar-chart',
      title: 'Resource Usage by Component',
      xAxisLabel: 'Component',
      yAxisLabel: 'Usage (%)',
      height: 300,
      horizontal: false,
      showLegend: false,
      showValueLabels: true,
      animation: true,
      accessibility: {
        enabled: true,
        ariaLabel: 'Resource usage by component bar chart',
        includeDataTable: true
      }
    });
    
    // Render initial data
    cpuLineChart.render(cpuTimeSeriesData);
    cpuGaugeChart.render(currentCpuValue);
    memoryGaugeChart.render(currentMemoryValue);
    resourceBarChart.render(resourceUsageData);
    
    // Update data function
    function updateData() {
      // Update CPU time series
      const now = new Date();
      cpuTimeSeriesData.labels.shift();
      cpuTimeSeriesData.labels.push(now);
      
      const newCpuValue = Math.min(95, Math.max(5, currentCpuValue + (Math.random() * 10 - 5)));
      currentCpuValue = newCpuValue;
      
      cpuTimeSeriesData.datasets[0].data.shift();
      cpuTimeSeriesData.datasets[0].data.push(newCpuValue);
      
      // Update memory value with smaller fluctuations
      currentMemoryValue = Math.min(95, Math.max(5, currentMemoryValue + (Math.random() * 6 - 3)));
      
      // Update resource usage with some randomness
      resourceUsageData.forEach(item => {
        item.value = Math.min(100, Math.max(1, item.value + (Math.random() * 8 - 4)));
      });
      
      // Render updated data
      cpuLineChart.render(cpuTimeSeriesData);
      cpuGaugeChart.render(currentCpuValue);
      memoryGaugeChart.render(currentMemoryValue);
      resourceBarChart.render(resourceUsageData);
    }
    
    // Set up event listeners
    document.getElementById('start-demo').addEventListener('click', () => {
      if (!demoRunning) {
        demoRunning = true;
        intervalId = setInterval(updateData, updateInterval);
        document.getElementById('start-demo').disabled = true;
        document.getElementById('stop-demo').disabled = false;
      }
    });
    
    document.getElementById('stop-demo').addEventListener('click', () => {
      if (demoRunning) {
        demoRunning = false;
        clearInterval(intervalId);
        document.getElementById('start-demo').disabled = false;
        document.getElementById('stop-demo').disabled = true;
      }
    });
    
    document.getElementById('update-data').addEventListener('click', () => {
      updateData();
    });
    
    const intervalSlider = document.getElementById('update-interval');
    const intervalDisplay = document.getElementById('interval-display');
    
    intervalSlider.addEventListener('input', () => {
      updateInterval = parseInt(intervalSlider.value);
      intervalDisplay.textContent = updateInterval;
      
      if (demoRunning) {
        clearInterval(intervalId);
        intervalId = setInterval(updateData, updateInterval);
      }
    });
    
    // Initialize controls
    document.getElementById('stop-demo').disabled = true;
  </script>
</body>
</html>
